代码分析见博客：

https://blog.csdn.net/weixin_40977054/article/category/9406296